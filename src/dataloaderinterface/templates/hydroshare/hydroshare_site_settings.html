{% load static %}

<style>
    .hydroshare-actions {
        display: flex;
        flex-direction: row;
    }
    .hydroshare-actions > * {
        margin: 8px 16px 8px 0;
    }
    .hs-img-container {
        margin-bottom: 8px;
    }

</style>

<div class="col-lg-6 col-sm-12">
    <hr>
    <div class="hs-img-container">
        <img src="https://www.hydroshare.org/static/img/logo-lg.png">
    </div>

    {% if resource %}

        {% if resource_did_not_load %}
            <p><span class="text-danger">Error:</span>
                Failed to connect to <a href="https://www.hydroshare.org">hydroshare.org</a>. Updating site data information might not work.
            </p>
        {% endif %}

        {% if resource_not_found %}

            <p class="text-danger"> <strong>HydroShare Resource not found. </strong></p>

            <p>
                This site was previously connected to a resource on <a href="https://www.hydroshare.org">hydroshare.org</a>,
                but it appears the resource does not exist anymore. Disconnect this resource to start sharing site data again with HydroShare.
            </p>

            <form method="post" action="{{ delete_resource_url }}">
                {% csrf_token %}
                <input type="submit" value="Disconnect Resource" class="mdl-button mdl-button--raised mdl-color--red mdl-color-text--white">
            </form>
        {% else %}
            <p>Sharing with HydroShare is currently turned
                <strong>
                    {% if resource.is_enabled %}
                        <span class="text-primary">ON</span>
                    {% else %}
                        <span class="text-warning">OFF</span>
                    {% endif %}
                </strong>
            </p>


            <p>Last updated on <strong>{{ resource.last_sync_date|date:date_format }}</strong></p>

            {% if resource.sync_type == 'scheduled' %}
                <p>Next update scheduled for <strong>{{ resource.m_next_sync_date|date:date_format }}</strong></p>
            {% endif %}

            <p><a href="https://www.hydroshare.org/resource/{{ resource.ext_id }}/" target="_blank">View data from this site in HydroShare</a></p>

        {#    <p>Click <span class="text-info">Update Now</span> to share latest data with HydroShare.</p>#}
            <p class="text-danger" id="hydroshare-error"></p>

            <div class="hydroshare-actions">
                <button id="update-now-button"
                        class="mdl-button mdl-button--raised mdl-button--accent"
                        {% if not resource.is_enabled or resource_not_found %}disabled{% endif %}>Update Now</button>

                <button id="show-hydroshare-settings-dialog"
                        class="mdl-button mdl-button--raised mdl-button--accent">
                    <i class="fa fa-cog fa-lg"></i>
                    Settings</button>

                <div class="mdl-spinner mdl-spinner--single-color mdl-js-spinner" id="hydroshare-progress-spinner"></div>
            </div>
        {% endif %}
    {% else %}

        <h5 class="hydroshare-title"><strong>Share Data On HydroShare</strong></h5>

        <p class="lead">
            Share your data on <em>hydroshare.org</em>.
            {# TODO: Implement a 'click here to learn more' link... #}
            <a href="#" id="display-hydroshare-info">Click here</a> to learn more.
        </p>
        <button id="show-hydroshare-settings-dialog"
                class="mdl-button mdl-button--raised mdl-button--accent">Turn On Sharing
        </button>

    {% endif %}
    <hr>
</div>

<div id="hs-target">
    {% include 'hydroshare/hydroshare_settings_modal.html' with resource=resource form=form site=site %}
</div>
